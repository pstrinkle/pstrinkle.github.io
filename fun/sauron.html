---
layout: fun
title: sauron
---
<p>Attempt at creating an arc that doesn't really look like the eye of sauron but rotates to 
follow the mouse position.  Similar to my <a href="follow.html">follow</a> javascript.

You can the rotation with CSS, but I wanted to try making the element drawn within the canvas rotate,
which apparently isn't possible without redrawing the canvas (there is an idea that you can store the
original canvas an as image into the new rotation which might be faster?).

If you rotate with CSS, make sure it's a square. :)</p>

<div class="row">
  <canvas id='eye' height="220" width="220" />
</div>

<div class="row">
  <p id='middle'></p>
  <p id='where'></p>
  <p id='position'></p>
  <p id='angle'></p>
</div>

<script>
  $(function() {
    var middleX, middleY;

    var drawArc = function() {
      /* https://jsfiddle.net/patrickactivatr/s310h382/ */
      var canvas = document.getElementById('eye');
      var ctx = canvas.getContext('2d');
      var x = canvas.width / 2;
      var y = canvas.height / 2;
      var radius = 100;

      ctx.clearRect(0,0,canvas.width,canvas.height); 

      // x1, y1, x2, y2
      // create a linear gradient over the line defined by the points.
      var gradient = ctx.createLinearGradient(0,0,canvas.width,0);
      gradient.addColorStop("0.0","white");
      gradient.addColorStop("0.3","red");
      gradient.addColorStop("0.7","red");
      gradient.addColorStop("1.0","white");

      ctx.beginPath();
      ctx.arc(x, y, radius, Math.PI, 0, false);
      ctx.lineWidth = 10;

      // line color
      ctx.strokeStyle = gradient;
      ctx.stroke();
    };
    
    drawArc();

    (function() {
      var $gb = $('#eye');
      var position = $gb.offset();
      var realWidth = $gb.outerWidth();
      var realHeight = $gb.outerHeight();
      middleX = position.left + (100/2);
      middleY = position.top + (100/2);
      $('#middle').text(middleX + ', ' + middleY);
    })();

    $(document).mousemove(function(event) {
      $('#where').text(event.pageX + ", " + event.pageY);
      
      var newY = 0;
      var newX = 0;
      var add = 0;

      /* done together in just four quadrants. */
      if (event.pageY < middleY && event.pageX < middleX) {
        /* upper left. */
        newY = middleY - event.pageY;
        newX = middleX - event.pageX;
      } else if (event.pageY < middleY && event.pageX > middleX) {
        /* upper right. */
        newY = middleY - event.pageY;
        newX = event.pageX - middleX;
        add = 0.25;
      } else if (event.pageY > middleY && event.pageX > middleX) {
        /* lower right. */
        newY = event.pageY - middleY;
        newX = event.pageX - middleX;
        add = 0.5;
      } else if (event.pageY > middleY && event.pageX < middleX) {
        /* lower left. */
        newY = event.pageY - middleY;
        newX = middleX - event.pageX;
        add = 0.75;
      }

      $('#position').text('x ' + newX + ', y ' + newY);
      var radians = Math.atan2(newY, newX);
      var degrees = radians * (180 / Math.PI);
      if (degrees > 90) {
        degrees = 180 - degrees;
      }
      /* handle the special cases. */
      if (add == 0.25 || add == 0.75) {
        degrees = 90 - degrees;
      }
      var percentage = degrees / 360;
      percentage += add;

      $('#angle').text(degrees);

      // rotate the eye...
      var $cvs = $('#eye');
      $cvs.css('-ms-transform', 'rotate(' + degrees + ')');
      $cvs.css('-o-transform', 'rotate(' + degrees + ')');
      $cvs.css('-webkit-transform', 'rotate(' + degrees + ')');
      $cvs.css('-moz-transform', 'rotate(' + degrees + ')');

    });
  });
</script>
