---
layout: fun
title: levelup2
---

<p>I wrote this as a +1, -1 animation for a view I needed, and it was fun.  Here's an attempt at reproducing it on this site.  I had a 
fun time writing this because JavaScript animations can be fun.</p>

<p>If you click the increment and decrement buttons it'll update the number via a cool custom animation I wrote that makes it look like
 a video game. :D</p>

<p><strong>This version I wrote as a jquery plugin, but I'd like to extend it with more formatting options before I publish it</strong></p>

<div class="row">
  <div class="col-md-12">
    <i class="fa fa-twitter-square fa-lg" style="color: #2AA9E0;"></i>&nbsp;Twitter <span>select <span style="font-weight: bold;" id='twitter_cnt'></span> more post(s)</span>
  </div>
</div>
<br />
<br />
<div class="row">
  <div class="col-md-6">
    <button id='incrementBtn' class="btn btn-default" type="button">Increment</button>
  </div>
  <div class="col-md-6">
    <button id='decrementBtn' class="btn btn-default" type="button">Decrement</button>
  </div>
</div>

<script>
  (function ($) {
    /**
     * Set up an animated incrementer/decrementer.
     * 
     * @param configOrCommand - Config object or command name
     *     Example: { ... };
     *     you may set any public property (see above);
     *     you may use .levelup('increment', incrementWith) to increment the value
     *     you may use .levelup('decrement', decrementWith) to decrement the value
     *
     * @param commandArgument - Some commands (like 'increment') may require an argument
     */
    $.fn.levelup = function(configOrCommand, commandArgument) {
      /* Also need to come up with some options and defaults. :D
       * should support value not being provided, to default as 1
       */

      var dataName = 'levelup';
      var trans = {'-webkit-transition' : 'all 0.25s',
                   '-moz-transition' : 'all 0.25s',
                   '-o-transition' : 'all 0.25s',
                   'transition' : 'all 0.25s'};

      function getStyle(top, left) {
        /* 
         * Should it always be bold? or is that incorrect, I can't recall yet.
         * I should have it check if the thing beneath it is bold?
         */
        return "font-weight: bold; position: absolute; top: " + top + "px; left: " + left + "px; z-index : 999;"
      }

      function animateDecrement($tw, next) {
        var p = $tw.position();
        var h = $tw.height();
        var w = $tw.width();            
        var nl = p.left + w; // start it all the way to the left, then figure out its width
        var nt = p.top; // they have the same height, so just position it at the same place.
        var $x = $('<span>', {text: "-1", style: getStyle(nt, nl) });
        // width is 0 until it's rendered.
        $tw.parent().append($x);
        var realWidth = $x.width();
        var newerLeft = nl - realWidth;
        $x.css('left', newerLeft + 'px');

        // lower if after 1/10th of a second, this is better.
        setTimeout(function(){
          $x.css(trans);
          var e = nt + (h);
          $x.css('top', e + 'px');
          setTimeout(function() {
            $x.remove();
            $tw.text(next); // so it goes down correctly
          }, 250);
        }, 100);
      }

      function animateIncrement($tw, next) {
        var p = $tw.position();
        var h = $tw.height();
        var w = $tw.width();
        var nl = p.left + w; // start it all the way to the left, then figure out its width
        var nt = p.top - h; // they have the same height, so just position it above by the height.
        var $x = $('<span>', {text: "+1", style: getStyle(nt, nl) });
        // width is 0 until it's rendered.
        $tw.parent().append($x);
        var realWidth = $x.width();
        var newerLeft = nl - realWidth;
        $x.css('left', newerLeft + 'px');

        // lower if after ~1/4th of a second.
        setTimeout(function(){
          $x.css(trans);
          var e = nt + (h);
          $x.css('top', e + 'px');
          setTimeout(function() {
            $x.remove();
            $tw.text(next);
          }, 250);
        }, 100);
      }

      if (typeof configOrCommand == 'string') {
        var curr = parseInt(this.data(dataName));

        if (configOrCommand === 'increment') {
          var next = curr + commandArgument;
          /* you want to update this here in case they call it a lot. */
          this.data(dataName, next);
          animateIncrement(this, next);
          return this;
        } else if (configOrCommand === 'decrement') {
          var next = curr - commandArgument;
          this.data(dataName, next);
          animateDecrement(this, next);
          return this;
        }
      }

      /* handle init here, I later plan to use other options, such as formatting. */
      return this.each(function() {
        var el = $(this), instance = el.data(dataName),
          config = $.isPlainObject(configOrCommand) ? configOrCommand : {};

        if (instance) {
          /* they've set up some data values for us already to use. */
        } else {
          var initialConfig = $.extend({}, el.data());
          config = $.extend(initialConfig, config);
          
          /* should have defaults. */
          if (config.start == undefined) {
            el.data(dataName, 0);
          } else {
            el.data(dataName, config.start);
          }
        }
      });
    };
  }(jQuery));

  $(function() {
    $('#twitter_cnt').levelup({'start' : 0});

    $('#incrementBtn').on('click', function(event) {
      $('#twitter_cnt').levelup('increment', 1);
      $(this).blur();
    });
    $('#decrementBtn').on('click', function(event) {
      $('#twitter_cnt').levelup('decrement', 1);
      $(this).blur();
    });
  });
</script>
